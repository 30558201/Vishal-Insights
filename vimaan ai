<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VIMAAN AI</title>
<style>
body {margin:0;padding:0;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;background:#fff;display:flex;justify-content:center;align-items:center;height:100vh;}
#vimaan-container {width:95%;max-width:600px;height:90vh;display:flex;flex-direction:column;border-radius:15px;box-shadow:0 10px 25px rgba(0,0,0,0.2);background:white;overflow:hidden;position:relative;}
#chat-header {padding:10px 15px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd;}
#chat-header .title-box {background:#000;color:#fff;padding:5px 10px;border-radius:8px;font-weight:bold;font-size:16px;}
#chat-header .logo {width:35px;height:35px;border-radius:8px;}
#vimaan-chat {flex:1;padding:15px;display:flex;flex-direction:column;overflow-y:auto;gap:10px;font-size:16px;line-height:1.5;position:relative;}
#middle-msg {position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);background:#f0f0f0;color:#333;padding:8px 12px;border-radius:10px;font-size:14px;font-style:italic;text-align:center;opacity:0.6;animation:blinkMessage 1.5s infinite;}
@keyframes blinkMessage {0%,50%,100% {opacity:0.6;} 25%,75% {opacity:1;}}
.message {max-width:70%;padding:12px 15px;border-radius:15px;word-wrap: break-word;cursor:text;white-space: pre-wrap;font-weight:500;}
.user {background:#f9f9f9;border:1px solid #ddd;align-self:flex-end;font-weight:normal;}
.ai {background:#fff;border:1px solid #ccc;align-self:flex-start;}
.typing {display:inline-block;width:50px;}
.typing span {display:inline-block;width:8px;height:8px;margin:0 2px;background:#555;border-radius:50%;animation:blink 1.4s infinite both;}
.typing span:nth-child(1) {animation-delay:0s;} .typing span:nth-child(2) {animation-delay:0.2s;} .typing span:nth-child(3) {animation-delay:0.4s;}
@keyframes blink {0%,80%,100%{opacity:0;} 40%{opacity:1;}}
#input-wrapper {display:flex;padding:10px;border-top:1px solid #ddd;align-items:center;background:white;}
#vimaan-input {flex:1;padding:12px 15px;border-radius:25px;border:1px solid #ccc;font-size:16px;outline:none;}
#vimaan-send {margin-left:10px;background:#000;color:white;border:none;border-radius:50%;width:50px;height:50px;font-size:22px;cursor:pointer;display:flex;justify-content:center;align-items:center;transition:0.3s;}
#vimaan-send:hover {background:#333;}
@media(max-width:480px){#vimaan-container {height:95vh;} #vimaan-input {font-size:14px;} #vimaan-send {width:45px;height:45px;} #chat-header .title-box {font-size:14px;padding:3px 6px;} #chat-header .logo {width:28px;height:28px;}}
.ai b {font-weight:bold;} .ai i {font-style:italic;} .ai u {text-decoration:underline;} .ai code {font-family:monospace;background:#f9f9f9;padding:2px 4px;border-radius:4px;}
</style>

<!-- ===== MathJax Library for equations & graphs ===== -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="vimaan-container">
    <!-- Header -->
    <div id="chat-header">
        <div class="title-box">VIMAAN AI</div>
        <img src="https://imgproxy.attic.sh/insecure/f:png/plain/https://attic.sh/r5u44asur5r6llxqsuclz8kdpz9b" class="logo" alt="VIMAAN Logo">
    </div>

    <!-- Chat -->
    <div id="vimaan-chat">
        <div id="middle-msg">
            Message from Vishal<br>
            <small style="font-size:12px; color:#555;">Ask AI, your name if Vishal knows you</small>
        </div>
    </div>

    <!-- Input -->
    <div id="input-wrapper">
        <input type="text" id="vimaan-input" placeholder="Ask anything…" />
        <button id="vimaan-send">&#9658;</button>
    </div>
</div>

<script>
const chatContainer = document.getElementById("vimaan-chat");
const inputField = document.getElementById("vimaan-input");
const sendBtn = document.getElementById("vimaan-send");
const middleMsg = document.getElementById("middle-msg");
let firstMessageSent = false;

// Append message
function appendMessage(sender, text){
    if(!firstMessageSent){middleMsg.remove(); firstMessageSent = true;}
    const msgDiv = document.createElement("div");
    msgDiv.classList.add("message", sender);
    chatContainer.appendChild(msgDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;

    if(sender==="ai"){
        let i=0;
        let interval = setInterval(()=>{
            if(i>=text.length){
                clearInterval(interval);
                // Render LaTeX equations properly
                MathJax.typesetPromise([msgDiv]).then(() => {
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                });
                return;
            }
            msgDiv.innerHTML += text[i];
            i++;
            chatContainer.scrollTop = chatContainer.scrollHeight;
        },20);
    }else{
        msgDiv.textContent = text;
    }
    return msgDiv;
}

// Show typing animation
function showTyping(){
    const typingDiv = document.createElement("div");
    typingDiv.classList.add("message","ai");
    typingDiv.innerHTML = `<div class="typing"><span></span><span></span><span></span></div>`;
    chatContainer.appendChild(typingDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;
    return typingDiv;
}

// Send message
async function sendMessage(){
    const question = inputField.value.trim();
    if(!question) return;
    appendMessage("user", question);
    inputField.value = "";

    const typingDiv = showTyping();

    try{
        const response = await fetch("https://api.openai.com/v1/chat/completions",{
            method:"POST",
            headers:{
                "Content-Type":"application/json",
                "Authorization":"Bearer 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"
            },
            body: JSON.stringify({
                model:"gpt-4o-mini",
                messages:[
                    {role:"system", content:"You are VIMAAN AI... [YOUR FULL SYSTEM PROMPT]"},
                    {role:"user", content: question}
                ],
                temperature:0.7,
                max_tokens:800
            })
        });

        const data = await response.json();
        const aiReply = data.choices[0].message.content;

        typingDiv.remove();
        appendMessage("ai", aiReply);

    }catch(err){
        typingDiv.remove();
        appendMessage("ai","Sorry, something went wrong ❌. Try again later.");
        console.error(err);
    }
}

// Event listeners
sendBtn.addEventListener("click", sendMessage);
inputField.addEventListener("keydown",(e)=>{
    if(e.key==="Enter" || e.keyCode===13){e.preventDefault(); sendMessage();}
});
</script>
</body>
</html>

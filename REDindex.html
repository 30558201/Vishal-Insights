<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#0F172A">
<title>Vishal Insights | Ultimate Live</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,600;1,600&display=swap" rel="stylesheet">

<style>
/* ===== VARIABLES ===== */
:root {
    --primary: #3b82f6;
    --text-main: #ffffff;
    --text-sub: #cbd5e1;
    --bg-night: linear-gradient(to bottom, #020617 0%, #1e1b4b 100%);
    --bg-day: linear-gradient(to bottom, #38bdf8 0%, #bae6fd 100%);
    --glass: rgba(255, 255, 255, 0.1);
    --glass-border: rgba(255, 255, 255, 0.15);
    --card-bg: rgba(15, 23, 42, 0.6);
    --nav-bg: rgba(15, 23, 42, 0.85);
    --ease: cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* DAY MODE COLORS */
body.day-mode {
    --text-main: #0f172a;
    --text-sub: #334155;
    --glass: rgba(255, 255, 255, 0.4);
    --glass-border: rgba(255, 255, 255, 0.5);
    --card-bg: rgba(255, 255, 255, 0.65);
    --nav-bg: rgba(255, 255, 255, 0.9);
}

/* SIMPLE MODE */
body.simple-mode #sky-layer, 
body.simple-mode canvas { display: none !important; background: var(--nav-bg); }

* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', sans-serif; -webkit-tap-highlight-color: transparent; }

body {
    background: #0f172a;
    color: var(--text-main);
    overflow-x: hidden;
    min-height: 100vh;
    transition: background 0.5s ease, color 0.5s ease;
}

/* ===== SKY LAYER ===== */
#sky-layer { position: fixed; inset: 0; z-index: -1; pointer-events: none; transition: background 1s ease; overflow: hidden; }

.night-gradient { background: var(--bg-night); width: 100%; height: 100%; position: absolute; top: 0; left: 0; transition: opacity 1s; }
.day-gradient { background: var(--bg-day); width: 100%; height: 100%; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 1s; }

body.day-mode .day-gradient { opacity: 1; }
body.day-mode .night-gradient { opacity: 0; }

/* Stars */
.star {
    position: absolute; background: white; border-radius: 50%;
    animation: twinkle var(--dur) infinite ease-in-out;
    opacity: 0;
}
@keyframes twinkle { 0%, 100% { opacity: 0.3; transform: scale(0.8); } 50% { opacity: 1; transform: scale(1.3); box-shadow: 0 0 8px white; } }

/* Celestial Bodies */
.celestial-body {
    position: absolute; top: 60px; right: 30px;
    transition: transform 1.2s var(--ease), opacity 1s; z-index: 2;
}
.sun {
    width: 100px; height: 100px;
    background: radial-gradient(circle, #fde047, #f59e0b);
    border-radius: 50%;
    box-shadow: 0 0 80px rgba(253, 224, 71, 0.9);
    opacity: 0; transform: translateY(80px) scale(0.6);
}
.moon {
    width: 80px; height: 80px;
    background: radial-gradient(circle at 35% 35%, #fff, #94a3b8);
    border-radius: 50%;
    box-shadow: 0 0 40px rgba(255,255,255,0.3);
    opacity: 0; transform: translateY(80px) scale(0.6);
}

body.day-mode .sun { opacity: 1; transform: translateY(0) scale(1); }
body.day-mode .moon { opacity: 0; transform: translateY(-50px) scale(0.5); }
body:not(.day-mode) .moon { opacity: 1; transform: translateY(0) scale(1); }
body:not(.day-mode) .sun { opacity: 0; transform: translateY(-50px) scale(0.5); }

/* Clouds */
.cloud {
    position: absolute; background: #fff; border-radius: 100px;
    filter: blur(20px); opacity: 0; z-index: 3;
    transition: opacity 2s ease, transform 2s ease;
}
.cloud.visible { opacity: 0.9; }

/* Precipitation Canvas */
canvas { position: fixed; inset: 0; z-index: 4; pointer-events: none; opacity: 0; transition: opacity 1s; }
canvas.active { opacity: 1; }

/* ===== LOGO ANIMATION (Center to Top-Left) ===== */
#logo-element {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%) scale(4); /* Start Big */
    width: 60px; height: 60px;
    border-radius: 18px;
    box-shadow: 0 0 80px rgba(59, 130, 246, 0.8);
    z-index: 5000;
    transition: all 1.5s cubic-bezier(0.19, 1, 0.22, 1);
    animation: breathe 3s infinite ease-in-out;
}
@keyframes breathe {
    0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
    50% { box-shadow: 0 0 60px rgba(59, 130, 246, 0.9); }
}

/* Final Logo State */
body.loaded #logo-element {
    top: 20px; left: 24px;
    transform: translate(0, 0) scale(1);
    width: 38px; height: 38px;
    border-radius: 10px;
    border: 1px solid var(--glass-border);
    animation: none;
    box-shadow: none;
}

/* ===== HEADER ===== */
.header {
    position: sticky; top: 0; z-index: 100;
    height: 80px; padding: 0 24px;
    display: flex; justify-content: flex-end; align-items: center; gap: 12px;
    background: var(--nav-bg);
    backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--glass-border);
    opacity: 0; transition: opacity 0.5s 1.2s;
}
body.loaded .header { opacity: 1; }

.header-btn {
    width: 42px; height: 42px; border-radius: 12px;
    background: var(--glass); border: 1px solid var(--glass-border);
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; position: relative; color: var(--text-main);
    transition: 0.2s;
}
.header-btn:active { transform: scale(0.95); background: rgba(255,255,255,0.2); }

.notif-dot {
    position: absolute; top: 8px; right: 8px; width: 8px; height: 8px;
    background: #ef4444; border-radius: 50%;
    box-shadow: 0 0 5px #ef4444;
}

/* Notification Panel */
.notif-panel {
    position: fixed; top: 90px; right: 20px; width: 320px;
    background: var(--nav-bg); border: 1px solid var(--glass-border);
    border-radius: 18px; padding: 20px; backdrop-filter: blur(30px);
    opacity: 0; visibility: hidden; transform: translateY(-10px); transition: 0.3s;
    z-index: 2000; box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}
.notif-panel.active { opacity: 1; visibility: visible; transform: translateY(0); }

/* Battery */
.battery-pill {
    display: flex; align-items: center; gap: 6px;
    font-size: 12px; font-weight: 700; color: var(--text-main);
    background: var(--glass); padding: 8px 14px; border-radius: 30px;
    border: 1px solid var(--glass-border);
}

/* ===== MAIN CONTAINER ===== */
.container { padding: 100px 24px 140px; max-width: 600px; margin: 0 auto; opacity: 0; transition: 1s 1.5s; position: relative; z-index: 10; }
body.loaded .container { opacity: 1; }

.hero { margin-bottom: 30px; }
.hero-date { font-size: 12px; font-weight: 800; color: var(--text-sub); text-transform: uppercase; letter-spacing: 1.5px; }
.hero-title { font-family: 'Playfair Display', serif; font-size: 38px; line-height: 1.1; margin-top: 5px; }

/* WEATHER CARD */
.weather-card {
    background: var(--card-bg); border: 1px solid var(--glass-border);
    border-radius: 26px; padding: 24px;
    backdrop-filter: blur(15px); margin-bottom: 30px;
    display: flex; justify-content: space-between; align-items: center;
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    position: relative; overflow: hidden; transition: 0.3s;
}
.wc-temp { font-size: 36px; font-weight: 300; letter-spacing: -1px; }
.wc-loc { font-size: 13px; font-weight: 700; display: flex; align-items: center; gap: 6px; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }
.live-badge { font-size: 9px; background: #ef4444; color: white; padding: 2px 6px; border-radius: 4px; margin-left: 5px; animation: pulse 2s infinite; }
@keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

/* SEARCH */
.search-box { position: relative; margin-bottom: 25px; }
.search-input {
    width: 100%; height: 55px; background: var(--card-bg);
    border: 1px solid var(--glass-border); border-radius: 18px;
    padding-left: 52px; font-size: 16px; color: var(--text-main);
    transition: 0.3s; backdrop-filter: blur(10px);
}
.search-input:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 0 4px rgba(59,130,246,0.25); }
.search-icon { position: absolute; left: 18px; top: 18px; opacity: 0.6; }

/* GRID */
.grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; perspective: 1000px; }

.app-card {
    background: var(--card-bg); border: 1px solid var(--glass-border);
    border-radius: 22px; padding: 22px;
    height: 170px; display: flex; flex-direction: column; justify-content: space-between;
    text-decoration: none; color: var(--text-main);
    transition: 0.4s var(--ease); backdrop-filter: blur(10px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.05);
}
.app-card:active { transform: scale(0.96); }

.app-icon {
    width: 52px; height: 52px; border-radius: 14px;
    display: flex; align-items: center; justify-content: center;
    background: rgba(255,255,255,0.1); font-size: 24px;
    margin-bottom: 12px;
    box-shadow: inset 0 0 20px rgba(255,255,255,0.05);
}
body.day-mode .app-icon { background: rgba(0,0,0,0.05); }

/* ===== DRAWER ===== */
.drawer-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(8px);
    opacity: 0; visibility: hidden; transition: 0.3s; z-index: 3000;
}
.drawer {
    position: fixed; top: 0; right: -280px; width: 280px; height: 100%;
    background: var(--nav-bg); padding: 35px; z-index: 3001;
    transition: 0.5s var(--ease); border-left: 1px solid var(--glass-border);
    display: flex; flex-direction: column; box-shadow: -20px 0 50px rgba(0,0,0,0.3);
}
.drawer.open { right: 0; }
.drawer-overlay.open { opacity: 1; visibility: visible; }

.menu-link {
    padding: 16px 0; color: var(--text-main); text-decoration: none;
    border-bottom: 1px solid var(--glass-border); font-size: 16px;
    display: flex; align-items: center; justify-content: space-between;
}

/* Switches */
.toggle-row {
    display: flex; justify-content: space-between; align-items: center;
    margin-top: 15px; padding: 12px; background: var(--glass);
    border-radius: 12px; border: 1px solid var(--glass-border);
}
.switch { position: relative; display: inline-block; width: 40px; height: 24px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider {
    position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
    background-color: #666; transition: .4s; border-radius: 34px;
}
.slider:before {
    position: absolute; content: ""; height: 16px; width: 16px;
    left: 4px; bottom: 4px; background-color: white;
    transition: .4s; border-radius: 50%;
}
input:checked + .slider { background-color: var(--primary); }
input:checked + .slider:before { transform: translateX(16px); }

/* ===== DOCK ===== */
.dock {
    position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%);
    background: var(--nav-bg); backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border); border-radius: 50px;
    padding: 12px 30px; display: flex; gap: 30px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.4); z-index: 900;
}
.dock-item { color: var(--text-sub); transition: 0.3s; display: flex; align-items: center; }
.dock-item.active { color: var(--primary); transform: translateY(-4px); }
.dock-item svg { width: 26px; height: 26px; stroke-width: 2; }

</style>
</head>
<body onload="initializeSystem()">

<img src="https://lh3.googleusercontent.com/pw/AP1GczP1FxDyqLI0EVbXpZEhgt9c9LvyJMaTUX4jySqgZ9FUGW0Zzzu8h4yf1y2XpVsmFGpOMMDgNbDF5MtnNfHQbh51Hq1V7kJLmQIJGnxFyi2ospz1ufeepCbpJ_63zAllNYgjQmOZxVhYwuQ9JVlZET86=w865-h900-s-no-gm" id="logo-element" alt="Logo">

<div id="sky-layer">
    <div class="night-gradient" id="nightBG"></div>
    <div class="day-gradient" id="dayBG"></div>
    
    <div class="celestial-body">
        <div class="sun"></div>
        <div class="moon"></div>
    </div>

    <div id="cloud-container"></div>
</div>

<canvas id="weather-canvas"></canvas>

<header class="header">
    <div class="battery-pill">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="6" width="18" height="12" rx="2" ry="2"></rect><line x1="23" y1="13" x2="23" y2="11"></line></svg>
        <span id="bat-text">--%</span>
    </div>

    <div class="header-btn" onclick="toggleAudio()" id="audio-btn">
        <svg id="audio-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line></svg>
    </div>

    <div class="header-btn" onclick="toggleNotif()">
        <div class="notif-dot"></div>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
    </div>

    <div class="header-btn" onclick="toggleDrawer()">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </div>
</header>

<div class="notif-panel" id="notif-panel">
    <h3 style="font-size:14px; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:8px; margin-bottom:10px;">Notifications</h3>
    
    <div style="display:flex; gap:10px; margin-bottom:15px;">
        <div style="min-width:30px; height:30px; background:var(--primary); border-radius:8px; display:flex; align-items:center; justify-content:center;">ðŸš€</div>
        <div>
            <strong>New Version</strong><br>
            <span style="opacity:0.7; font-size:11px;">You are experiencing the new version of Vishal Insights.</span>
        </div>
    </div>
    
    <div style="display:flex; gap:10px;">
        <div style="min-width:30px; height:30px; background:#10b981; border-radius:8px; display:flex; align-items:center; justify-content:center;">âœ¨</div>
        <div>
            <strong>Smooth UI</strong><br>
            <span style="opacity:0.7; font-size:11px;">07-02-2026 â€¢ Performance optimized.</span>
        </div>
    </div>
</div>

<div class="container">
    
    <div class="hero">
        <div class="hero-date" id="date-text">DETECTING TIME...</div>
        <div class="hero-title" id="greeting-text">Welcome</div>
    </div>

    <div class="weather-card">
        <div>
            <div class="wc-loc">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                Chamba, HP <span class="live-badge">LIVE</span>
            </div>
            <div class="wc-temp" id="wc-temp">--Â°C</div>
            <div class="wc-desc" id="wc-desc">Fetching Live Data...</div>
        </div>
        <div id="wc-icon">
            <svg width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
        </div>
    </div>

    <div class="search-box">
        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <input type="text" class="search-input" id="search" placeholder="Search apps, tools & AI..." onkeyup="filterApps()">
    </div>

    <div class="grid">
        <a href="https://30558201.github.io/Vishal-Insights/craft.html" class="app-card search-item">
            <div class="app-icon" style="color:#a855f7"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg></div>
            <div>
                <div style="font-weight:700;">Baba Craft</div>
                <div style="font-size:11px; opacity:0.7;">3D Engine</div>
            </div>
        </a>

        <a href="game.html" class="app-card search-item">
            <div class="app-icon" style="color:#3b82f6"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></div>
            <div>
                <div style="font-weight:700;">Baba Run</div>
                <div style="font-size:11px; opacity:0.7;">Arcade</div>
            </div>
        </a>

        <a href="insightstv.html" class="app-card search-item">
            <div class="app-icon" style="color:#f59e0b"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect><polyline points="17 2 12 7 7 2"></polyline></svg></div>
            <div>
                <div style="font-weight:700;">Insights TV</div>
                <div style="font-size:11px; opacity:0.7;">Streaming</div>
            </div>
        </a>

        <a href="vimaan.html" class="app-card search-item">
            <div class="app-icon" style="color:#10b981"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2 2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z"></path><path d="M12 16a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2z"></path><line x1="12" y1="8" x2="12" y2="16"></line></svg></div>
            <div>
                <div style="font-weight:700;">Vimaan AI</div>
                <div style="font-size:11px; opacity:0.7;">Smart Chat</div>
            </div>
        </a>

        <a href="blogs.html" class="app-card search-item">
            <div class="app-icon" style="color:#ec4899"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg></div>
            <div>
                <div style="font-weight:700;">Blogs</div>
                <div style="font-size:11px; opacity:0.7;">Articles</div>
            </div>
        </a>

        <a href="about.html" class="app-card search-item">
            <div class="app-icon" style="color:#64748b"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg></div>
            <div>
                <div style="font-weight:700;">About</div>
                <div style="font-size:11px; opacity:0.7;">Info</div>
            </div>
        </a>
    </div>
</div>

<div class="dock">
    <a href="index.html" class="dock-item active"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg></a>
    <a href="game.html" class="dock-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></a>
    <a href="insightstv.html" class="dock-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect><polyline points="17 2 12 7 7 2"></polyline></svg></a>
</div>

<div class="drawer-overlay" onclick="toggleDrawer()"></div>
<div class="drawer">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2 style="font-weight:700;">Menu</h2>
        <div onclick="toggleDrawer()" style="cursor:pointer; padding:5px;">âœ•</div>
    </div>
    
    <div class="toggle-row">
        <span style="font-size:14px; font-weight:600;">Remove Weather</span>
        <label class="switch">
            <input type="checkbox" onchange="toggleSimpleMode(this)">
            <span class="slider"></span>
        </label>
    </div>
    
    <div class="toggle-row" style="margin-top:10px;">
        <span style="font-size:14px; font-weight:600;">Force Dark Mode</span>
        <label class="switch">
            <input type="checkbox" onchange="toggleDarkMode(this)">
            <span class="slider"></span>
        </label>
    </div>

    <div style="margin-top:20px;">
        <a href="index.html" class="menu-link">Home</a>
        <a href="https://30558201.github.io/Vishal-Insights/craft.html" class="menu-link">Baba Craft</a>
        <a href="game.html" class="menu-link">Baba Run</a>
        <a href="insightstv.html" class="menu-link">Insights TV</a>
        <a href="vimaan.html" class="menu-link">Vimaan AI</a>
        <a href="blogs.html" class="menu-link">Blogs</a>
        <a href="about.html" class="menu-link">About Us</a>
    </div>
</div>

<script>
    // 1. SYSTEM INITIALIZATION
    function initializeSystem() {
        setTimeout(() => {
            document.body.classList.add('loaded');
            initBattery();
        }, 1500);

        initParticles(); 
        generateStars(); 
        updateDate();
        fetchChambaWeather(); // Start Real-Time Fetch
        
        // Refresh weather every 10 mins
        setInterval(fetchChambaWeather, 600000);
    }

    // 2. REAL-TIME CHAMBA WEATHER API
    async function fetchChambaWeather() {
        try {
            // Open-Meteo API for Chamba, HP (Lat: 32.55, Long: 76.12)
            const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=32.55&longitude=76.12&current_weather=true');
            const data = await response.json();
            const weather = data.current_weather;
            
            updateUIWithRealData(weather.temperature, weather.weathercode, weather.is_day);
        } catch (error) {
            console.error("Weather Fetch Failed, using Fallback", error);
            // Fallback to simulation if offline
            updateUIWithRealData(15, 0, 0); 
        }
    }

    // 3. UI UPDATE LOGIC (Syncs Background to Real Data)
    function updateUIWithRealData(temp, code, isDay) {
        const body = document.body;
        const wDesc = document.getElementById('wc-desc');
        const wTemp = document.getElementById('wc-temp');
        const wIcon = document.getElementById('wc-icon');
        const greeting = document.getElementById('greeting-text');
        
        // Update Text
        wTemp.innerText = temp + "Â°C";
        
        // Determine Weather Condition from WMO Code
        let condition = 'clear';
        let descText = "Clear Sky";

        if (code >= 95) { condition = 'storm'; descText = "Thunderstorm"; }
        else if (code >= 71) { condition = 'snow'; descText = "Snowfall"; }
        else if (code >= 51) { condition = 'rain'; descText = "Rainy"; }
        else if (code >= 1) { condition = 'clouds'; descText = "Cloudy"; }
        
        wDesc.innerText = descText + " â€¢ Live";

        // Sync Day/Night Background
        if (isDay === 1) {
            body.classList.add('day-mode');
            greeting.innerText = "Good Morning";
            document.getElementById('dayBG').style.opacity = '1';
            document.getElementById('nightBG').style.opacity = '0';
        } else {
            body.classList.remove('day-mode');
            greeting.innerText = "Good Evening";
            document.getElementById('dayBG').style.opacity = '0';
            document.getElementById('nightBG').style.opacity = '1';
        }

        // Trigger Visual Effects
        syncVisuals(condition, isDay);
    }

    function syncVisuals(cond, isDay) {
        const canvas = document.getElementById('weather-canvas');
        const cloudCont = document.getElementById('cloud-container');
        
        // Reset
        canvas.classList.remove('active');
        setParticleType('none');
        cloudCont.innerHTML = '';

        if (cond === 'rain') {
            generateClouds(15);
            setTimeout(() => { setParticleType('rain'); canvas.classList.add('active'); }, 1000);
        } else if (cond === 'snow') {
            generateClouds(10);
            setTimeout(() => { setParticleType('snow'); canvas.classList.add('active'); }, 1000);
        } else if (cond === 'clouds') {
            generateClouds(12);
        } else {
            // Clear
            if (isDay === 0) generateStars();
        }
    }

    // 4. PARTICLE ENGINE
    let canvas, ctx, particles = [], pType = 'none';
    function initParticles() {
        canvas = document.getElementById('weather-canvas');
        ctx = canvas.getContext('2d');
        resize();
        window.addEventListener('resize', resize);
        loop();
    }
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    function setParticleType(t) { pType = t; particles = []; }

    function loop() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        if(pType !== 'none') {
            if(Math.random() > 0.7) {
                particles.push({
                    x: Math.random()*canvas.width, 
                    y: -10, 
                    speed: pType==='rain'? Math.random()*15+15 : Math.random()*3+2,
                    size: pType==='rain'? 20 : 4
                });
            }
            for(let i=0; i<particles.length; i++){
                let p = particles[i];
                p.y += p.speed;
                ctx.fillStyle = pType==='rain'?'rgba(174,194,224,0.8)':'rgba(255,255,255,0.9)';
                ctx.beginPath();
                if(pType==='rain') ctx.rect(p.x, p.y, 1, p.size);
                else ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                ctx.fill();
                if(p.y > canvas.height) particles.splice(i,1);
            }
        }
        requestAnimationFrame(loop);
    }

    // 5. CLOUDS & STARS
    function generateClouds(num) {
        const cont = document.getElementById('cloud-container');
        for(let i=0; i<num; i++){
            let c = document.createElement('div');
            c.className = 'cloud visible';
            c.style.width = Math.random()*180+120 + 'px';
            c.style.height = Math.random()*60+40 + 'px';
            c.style.top = Math.random()*40 + '%';
            c.style.left = Math.random()*100 + '%';
            cont.appendChild(c);
        }
    }
    function generateStars() {
        const sky = document.querySelector('.night-gradient');
        sky.innerHTML = '';
        for(let i=0; i<70; i++) {
            let s = document.createElement('div');
            s.className = 'star';
            s.style.left = Math.random()*100 + '%';
            s.style.top = Math.random()*60 + '%';
            s.style.width = Math.random()*2+1 + 'px';
            s.style.height = s.style.width;
            s.style.setProperty('--dur', Math.random()*2+1 + 's');
            sky.appendChild(s);
        }
    }

    // 6. AUDIO ENGINE (LOUD)
    let audioCtx, osc, gainNode, isPlaying = false;
    function toggleAudio() {
        if(!window.AudioContext && !window.webkitAudioContext) return;
        if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        const btn = document.getElementById('audio-icon');
        
        if(isPlaying) {
            gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 1);
            setTimeout(()=> { osc.stop(); isPlaying=false; }, 1000);
            btn.style.opacity = "0.5";
        } else {
            osc = audioCtx.createOscillator();
            gainNode = audioCtx.createGain();
            osc.type = 'triangle'; 
            osc.frequency.setValueAtTime(120, audioCtx.currentTime); 
            gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime); // 20% Volume (Loud enough)
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            isPlaying = true;
            btn.style.opacity = "1";
        }
    }

    // 7. UTILS
    function updateDate() {
        const d = new Date();
        document.getElementById('date-text').innerText = d.toLocaleDateString('en-US', {weekday:'long', month:'short', day:'numeric'}).toUpperCase();
    }
    function initBattery() {
        if(navigator.getBattery) navigator.getBattery().then(b => document.getElementById('bat-text').innerText = Math.round(b.level*100)+'%');
    }
    function toggleDrawer() {
        document.querySelector('.drawer').classList.toggle('open');
        document.querySelector('.drawer-overlay').classList.toggle('open');
    }
    function toggleNotif() {
        document.getElementById('notif-panel').classList.toggle('active');
    }
    function toggleSimpleMode(cb) {
        if(cb.checked) document.body.classList.add('simple-mode');
        else document.body.classList.remove('simple-mode');
    }
    function toggleDarkMode(cb) {
        if(cb.checked) document.body.classList.remove('day-mode');
        else fetchChambaWeather(); // Revert to live
    }
    function filterApps() {
        const val = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('.search-item').forEach(el => {
            el.style.display = el.innerText.toLowerCase().includes(val) ? 'flex' : 'none';
        });
    }

</script>
</body>
</html>
